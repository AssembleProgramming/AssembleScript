$=====================================================================================
                            SELF TEST IMPLEMENTATION
======================================================================================$
# This file contains the implementations and test cases for the current functionality of 
# AssembleScript. Write to this file is strictly prohibited
#                         ❌ DO NOT EDIT THIS FILE ❌

$=====================================================================================
                        Factorial calculation using recursion
======================================================================================$
def factorial_recursive(n) {
  ifWorthy(n == 0 || n == 1) {
    return 1;
  }
  return n * factorial_recursive(n - 1);
}

# Test case for factorial_recursive
def test_factorial_recursive() {
  vision("Testing factorial_recursive...");
  assertEqual(factorial_recursive(0), 1);
  assertEqual(factorial_recursive(1), 1);
  assertEqual(factorial_recursive(5), 120);
  assertEqual(factorial_recursive(10), 3628800);
  vision(" ");
}

$=====================================================================================
                            Factorial calculation using Loop
======================================================================================$
def factorial_loop(n) {
  ifWorthy(n == 0 || n == 1){
    return 1;
  }
  newAvenger result = 1;
  wakandaFor i in 1 to n {
    result = result * i;
  }
  return result;
}

# Test case for factorial_loop
def test_factorial_loop() {
  vision("Testing factorial_loop...");
  assertEqual(factorial_loop(0), 1);
  assertEqual(factorial_loop(1), 1);
  assertEqual(factorial_loop(5), 120);
  assertEqual(factorial_loop(10), 3628800);
  vision(" ");
}

$=====================================================================================
                Check if a number is prime using the Sieve of Eratosthenes
======================================================================================$
def is_prime_sieve(n) {
  ifWorthy(n <= 1) {
    return HYDRA;
  }
  team sieve(100) = {SHIELD};
  sieve[0] = HYDRA;
  sieve[1] = HYDRA;

  wakandaFor idx in 2 to 99 step 1{
    sieve[idx] = SHIELD;
  }
  newAvenger i = 2;
  fightUntil(i * i <= 100){
    ifWorthy(sieve[i]){
      newAvenger j = i * i;
      fightUntil(j <= 100){
        sieve[j] = HYDRA;
        j = j + i;
      }
    }
    i = i + 1;
  }

  return sieve[n];
}

# Test case for is_prime_sieve
def test_is_prime_sieve() {
  vision("Testing is_prime_sieve...");
  assertEqual(is_prime_sieve(2), SHIELD);
  assertEqual(is_prime_sieve(3), SHIELD);
  assertEqual(is_prime_sieve(4), HYDRA);
  assertEqual(is_prime_sieve(17), SHIELD);
  assertEqual(is_prime_sieve(25), HYDRA);
  vision(" ");
}


$=====================================================================================
                            Nested for loops
======================================================================================$
def nested_for_test() {
  vision("Testing nested_for_test...");
  newAvenger sum = 0;
  wakandaFor i in 1 to 2 {
    wakandaFor j in 1 to 2 {
      sum = sum + (i * j);
    }
  }
  assertEqual(sum, 9); 
  vision(" ");
}

$=====================================================================================
                        Factorial calculation using recursion
======================================================================================$
def reverse_int(num){
    ifWorthy(num <= 0){
        return num;
    }
    newAvenger ans = 0;
    fightUntil(num > 0){
        newAvenger lastDigit = num % 10;
        ans = ans * 10 + lastDigit; 
        num = floor(num / 10);
    }
    return ans;
}
# Test case for reverse_int
def test_reverse_int(){
    vision("Testing reverse_int...");
    assertEqual(reverse_int(131), 131);
    assertEqual(reverse_int(123), 321);
    assertEqual(reverse_int(0), 0);
    assertEqual(reverse_int(111), 111);
    assertEqual(reverse_int(9), 9);
    assertEqual(reverse_int(<MINUS>1), <MINUS>1);
    assertEqual(reverse_int(1734), 4371);
    vision(" ");
}

$=====================================================================================
                        Binary search Iterative
======================================================================================$
def binary_search(arr, n, key){
    newAvenger lo = 0;
    newAvenger hi = n-1;

    fightUntil(lo <= hi){
        newAvenger mid = floor(lo + (hi - lo)/2);
        ifWorthy(arr[mid] ==  key){
            return SHIELD;
        }
        otherwise ifWorthy(arr[mid] >  key){
            hi = mid - 1;
        }
        otherwise{
            lo = mid + 1;
        }
    }
    return HYDRA;
}
# Test case for binary_search
def test_binary_search(){
    team arr_zero(1) = {1};
    newAvenger size_zero = 1;

    team arr_one(7) = {1,2,3,4,5,6,7};
    newAvenger size_one = 7;

    team arr_two(6) = {1,2,3,4,5,6};
    newAvenger size_two = 6;

    team arr_three(0) = {};
    newAvenger size_three = 0;

    team arr_four(3) = {1,2,3};
    newAvenger size_four = 3;

    team arr_five(1) = {1};
    newAvenger size_five = 1;

    vision("Testing reverse_int...");
    assertEqual(binary_search(arr_zero, size_zero, 1), SHIELD);
    assertEqual(binary_search(arr_one, size_one, 4), SHIELD);
    assertEqual(binary_search(arr_two, size_two, 8), HYDRA);
    assertEqual(binary_search(arr_three, size_three, 1), HYDRA);
    assertEqual(binary_search(arr_four, size_four, 1), SHIELD);
    assertEqual(binary_search(arr_five, size_five, 0), HYDRA);

    vision(" ");
}
$=====================================================================================
                        Binary search Recursive
======================================================================================$

def recursiveBinarySearchFunction(arr, x,start, end){
    ifWorthy(start > end) 
    {
        return HYDRA;
    }
    newAvenger mid = floor((start + end) / 2);

    ifWorthy(arr[mid] == x){
        return SHIELD;
    }

    ifWorthy(arr[mid] > x) 
    {
        
        return recursiveBinarySearchFunction(arr, x, start, mid - 1);
    }
    otherwise{ 
        return recursiveBinarySearchFunction(arr, x, mid + 1, end);
    }
}



def test_recursive_binary_code() {
  team arr(6) = {1, 3, 5, 7, 8, 9};
  vision("Testing Binary search recurssive");
  assertEqual(recursiveBinarySearchFunction(arr,5,0,5), SHIELD);
  assertEqual(recursiveBinarySearchFunction(arr,9,0,5), SHIELD);
  assertEqual(recursiveBinarySearchFunction(arr,0,0,5), HYDRA);
  assertEqual(recursiveBinarySearchFunction(arr,3,0,5), SHIELD);
  assertEqual(recursiveBinarySearchFunction(arr,100,0,5), HYDRA);
  vision(" ");
}


$ ==========================================================================
                            Variable Declaration 
========================================================================== $
def test_declare_var(){
    vision("Testing Variable Declaration...");
    newAvenger a = 10;
    newEternal b = 11;
    assertEqual(a, 10);
    assertEqual(b, 11);
    vision(" ");
}
$ ==========================================================================
                            fightUntil Loop
========================================================================== $
def test_fightUntil_loop(){
    vision("Testing Break In loop...");
    newAvenger i = 0;
    fightUntil(i < 10){
        ifWorthy(i == 8){
            endGame;
        }
        i = i + 1;
    }
    assertEqual(i,9);
    vision(" ");
}
$ ==========================================================================
                            Nested Teams
========================================================================== $
def test_nested_teams(){
    vision("Testing Nested Teams...");
    newAvenger str = "Loki";
    team apk(1) = {str};
    team arr(1) = {apk};
    wakandaFor i in 0 to 0{
        wakandaFor j in 0 to 0{
            assertEqual(arr[i][j], "Loki");
            vision(" ");
            return;
        }
    }
}
$ ==========================================================================
                            String
========================================================================== $
def test_string(){
    vision("Testing String Arithmetic...");
    newEternal string = "12";
    newEternal s = 3;

    newAvenger resStrAdd = string + s;
    newAvenger resStrMul = string*s;
    newAvenger resStrMul_ = s * string;

    assertEqual(resStrAdd, "123");
    assertEqual(resStrMul, "121212");
    assertEqual(resStrMul_, "121212");

    newAvenger numstr = parseInt(string);
    newAvenger nums = parseInt(s);

    assertEqual(numstr + nums, 15);
    assertEqual(numstr * nums, 36);

    assertEqual(string, "12");
    vision(" ");
}
$ ==========================================================================
                            Nums
========================================================================== $
def test_nums(){
    vision("Testing Number Arithmetic...");
    newAvenger n = 2;
    newAvenger m = 10;

    assertEqual(n ^ m, 1024);
    assertEqual(pow(n, m), 1024);
    vision(" ");
}
$ ==========================================================================
                            ifWorthy-CHAIN
========================================================================== $
def test_ifWorthy_chain(){
    vision("Testing ifWorthy-CHAIN...");
    newAvenger name = "Shashank";
    ifWorthy(name[0] == "S"){
        ifWorthy(name[1] == "h"){
            ifWorthy(name[2] == "a"){
                ifWorthy(name[3] == "s"){
                    ifWorthy(name[4] == "h"){
                        ifWorthy(name[5] == "a"){
                            ifWorthy(name[6] == "n"){
                                ifWorthy(name[7] == "k"){
                                    assertEqual("HI", "HI");
                                    vision(" ");
                                    return;
                                } 
                            } 
                        } 
                    } 
                    vision("❌ You should never reach here!!!");
                } 
            } 
        }   
    }
}

$ ==========================================================================
                            Teams
========================================================================== $
def test_teams(){
    vision("Testing teams...");
    team avengers(4) = {"Captain America", "Iron Man", "Thor", "Hulk"};

    newAvenger firstAvenger = avengers[0];
    newAvenger secondAvenger = avengers[1];

    assertEqual(firstAvenger, "Captain America");
    assertEqual(secondAvenger, "Iron Man");


    team male(10) = {"Captain America", "Iron Man" ,"Dr. Strange", "Hulk", "Hawkeye", "Spiderman", "Thor", "T`Challa", "Ant Man", "Moon Knight"};
    team female(7) = {"Black Widow","Captain Marvel","Wanda Maximoff","She Hulk","Ms Marvel","Gamora","Nebula"};
    team avenger(2) = {male, female};

    assertEqual(avenger[0][4], "Hawkeye");
    assertEqual(avenger[1][6], "Nebula");

    vision(" ");
}
$ ==========================================================================
                            User Defined Functions
========================================================================== $
def test_user_defined_twopointo(){
    vision("Testing User Defined Functions...");
    def f(){
        return ("Called f");
    }
    def f_(){
        return ("Called f_");
    }
    team functions(2) = {f(), f_};
    assertEqual(functions[1](),"Called f_");

    def testFunction(){
        ifWorthy(HYDRA){
            ifWorthy(HYDRA){
                return 10;
            }
            otherwise{
                ifWorthy(HYDRA){
                    return 20;
                }
                otherwise{
                    ifWorthy(HYDRA){
                        return 30;
                    }
                    otherwise{
                        return 11;
                    }
                }
            }
        }
        otherwise ifWorthy(SHIELD){
            ifWorthy(HYDRA){
                return 100;
            }
            otherwise{
                ifWorthy(HYDRA){
                    return 200;
                }
                otherwise{
                    ifWorthy(HYDRA){
                        return 300;
                    }
                    otherwise{
                        return 1000;
                        vision("❌ You should never reach here!!!");
                        
                    }

                }
                vision("❌ You should never reach here!!!");
            }
        }
        otherwise{
            return 21;
        }
    }
    def main(){
        assertEqual(testFunction(), 1000);
    }

    main();
    vision(" ");
}

$ ==========================================================================
                            Return in switch
========================================================================== $
def test_return_in_switch(){
    vision("Testing User Defined Functions in Switch...");
    def switchTest(c){
        multiverse(c){
            madness 0:
                return "Case 0";
            madness 1:
                return "Case 1";
            madness 2:
                return "Case 2";
            madness 3:
                return "Case 3";
            default:
                return "Default";
        }
    }
    vision(typeOf(switchTest(0)));
    assertEqual(switchTest(0), "Case 0");
    def stringSwitchTest(c){
        multiverse(c){
            madness "one":
                return "String Case 1";
            madness "two":
                return "String Case 2";
            madness "three":
                return "String Case 3";
            madness "four":
                return "String Case 4";
            default:
                return "String Case Default";
        }
    }

    assertEqual(stringSwitchTest("one"), "String Case 1");
    vision(" ");
}

$ ==========================================================================
                            Return in fightUntil loop
========================================================================== $
def test_return_in_fightUntil_loop(){
    vision("Testing Return in while loop...");
    team testArray(6) = {11,13,17,19,23,27};
    team testArray_(6) = {11,13,17,20,23,27};
    def isEvenPresent(arr){
        newAvenger idx = 0;
        fightUntil(idx < 6){
            ifWorthy(arr[idx] % 2 == 0){
                return SHIELD;
            }
            idx = idx + 1;
        }
        return HYDRA;
    }

    assertEqual(isEvenPresent(testArray), HYDRA);
    assertEqual(isEvenPresent(testArray_), SHIELD);

}


$=====================================================================================
                            Run all the test cases
======================================================================================$
def run_tests() {
  test_factorial_recursive();
  test_factorial_loop();
  test_is_prime_sieve();
  nested_for_test();
  test_reverse_int();
  test_binary_search();
  test_recursive_binary_code();
  test_declare_var();
  test_fightUntil_loop();
  test_nested_teams();
  test_string();
  test_nums();
  test_ifWorthy_chain();
  test_teams();
  test_user_defined_twopointo();
  test_return_in_switch();
  test_return_in_fightUntil_loop();

}

run_tests();




















